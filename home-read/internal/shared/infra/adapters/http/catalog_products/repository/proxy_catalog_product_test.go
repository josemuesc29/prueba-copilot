package repository

import (
	"ftd-td-home-read-services/cmd/config"
	mocks_server "ftd-td-home-read-services/test/mocks/server"
	"github.com/gin-gonic/gin"
	"github.com/stretchr/testify/assert"
	"go.uber.org/mock/gomock"
	"net/http"
	"net/http/httptest"
	"net/url"
	"testing"
)

const (
	responseOKCatalogProducts            = "{\n    \"deliveryTime\": \"35 min. promedio\",\n    \"labelPum\": \"Gramos a $\",\n    \"measurePum\": 48,\n    \"listUrlImages\": [\n        \"https://lh3.googleusercontent.com/YlFFxbzrydDnAhYXPad4LeVaJIS0rUesFdGGebQuDohRwXZszjhVX3RisyNYCCyTLPzaO-KCCqwMsogR6StzJi0fxr5P7dCGMAs7IHfrAam-aLzU\",\n        \"https://lh3.googleusercontent.com/iqZJjNBXcZf10ry3d2Jcm7BE3wt4N5pfM4nRImmI9HIFgKlUnhGL2dmAPvLXIftW7ebFfKfUsl_id-AarKy05WOtAEq2EZcDVN0t8T7SQU-zGBbg\",\n        \"https://lh3.googleusercontent.com/_5oF3ED1Dww6L-EzMC_OmrcSEFRcsxKx4zepkWFACQHjl0agAdf1dyR3spkEqZO2gT5O0ksxOnciRv3V-EGaFkiKAjD3EtfU_RvR5S3uquAKGkBX\",\n        \"https://lh3.googleusercontent.com/I5RlivL-BbQGAqxwPlv1c9o7IzSp-Loj07xK8jp9y3vktNCoVldb_exrIdbYa0IlV4sFs99ur9MYf_98VLGNSc4PHf_p1hu3Ej6ZAEFBNprxkYnc\",\n        \"https://lh3.googleusercontent.com/A6mkZoDcye3kJFywIN7ez9evNk8DMRgOg713jMicJ-9K6cigJvM4MvgR-U3WvMwB3dcGIbeDvwogNj9Fr5rSoaSNFZXsFs4VWcRk03tYis-j0iig\"\n    ],\n    \"outofstore\": false,\n    \"onlyOnline\": false,\n    \"marca\": \"Cetaphil\",\n    \"mediaImageUrl\": \"https://lh3.googleusercontent.com/4lhwm7XEzD6MZquvwnXR9qb2FgdW_IDS9uI3Bem78wVNCjqgPnM_KudM_M5Tvc46-tzxyaTwyYyXORw6Hb9qAoyuAwcstinPnD22-hUIBsFLrEzWNw\",\n    \"barcodeList\": [\n        \"263550021\",\n        \"3499320014540\",\n        \"03499320014540\"\n    ],\n    \"rms_deparment\": \"CUIDADO DE LA PIEL DERMOCOSMET\",\n    \"rms_class\": \"CUIDADO FACIAL DERMOCOSMETICOS\",\n    \"rms_group\": \"DERMOCOSMETICOS\",\n    \"rms_subclass\": \"CUIDADO FACIAL DERMOCOSMETICOS\",\n    \"fullPrice\": 148950,\n    \"sales\": 418,\n    \"classification\": [\n        {\n            \"id\": 611,\n            \"name\": \"Dermocosmética\",\n            \"typeId\": 1,\n            \"typeName\": \"DEPARTAMENTO\"\n        },\n        {\n            \"id\": 612,\n            \"name\": \"Facial\",\n            \"typeId\": 2,\n            \"typeName\": \"CATEGORIA\"\n        },\n        {\n            \"id\": 616,\n            \"name\": \"Hidratantes faciales\",\n            \"typeId\": 3,\n            \"typeName\": \"SUBCATEGORIA\"\n        }\n    ],\n    \"brand\": \"2008M-0008623\",\n    \"categorie\": \"Facial\",\n    \"departments\": [\n        \"Dermocosmética\"\n    ],\n    \"taxRate\": 19,\n    \"subCategory\": \"Hidratantes faciales\",\n    \"barcode\": \"3499320014540\",\n    \"mediaDescription\": \"Gel Hidratante Cetaphil Facial Water Gel x 48 gr\",\n    \"largeDescription\": \"Gel Hidratante Facial Cetaphil Water Gel brinda a la piel una hidratación intensa y prolonagada durante 72 horas. Ideal para todo tipo de pieles incluidas las mixtas y grasa.\",\n    \"stores_with_stock\": [\n        22,\n        1\n    ],\n    \"id_highlights\": [\n        51933,\n        52276\n    ],\n    \"offerPrice\": 111712.5,\n    \"offerText\": \"25%\",\n    \"offerDescription\": \"¡Aprovecha!\",\n    \"stores_with_offer\": [\n        26,\n        80\n    ],\n    \"id\": \"263550021\",\n    \"primePrice\": 104265,\n    \"primeTextDiscount\": \"30%\",\n    \"primeDescription\": \"¡Aprovecha!\",\n    \"Prime\": \"si\",\n    \"stores_with_prime_offer\": [\n        26,\n        80\n    ],\n    \"id_suggested\": [\n        24611\n    ],\n    \"fullPriceByCity\": [\n        {\n            \"cityCode\": \"VVC\",\n            \"fullPrice\": 148950\n        }\n    ],\n    \"idOffersGroup\": [\n        52088\n    ],\n    \"offerStartDate\": 1746075600000,\n    \"offerEndDate\": 1746507540000,\n    \"lastUpdate\": {\n        \"jobName\": \"UPDATE_SUGGEST\",\n        \"timeStamp\": 1747263900270\n    },\n    \"supplier\": \"GALDERMA MASIVO\",\n    \"grayDescription\": \" \",\n    \"highlight\": \"false\",\n    \"requirePrescription\": \"false\",\n    \"anywaySelling\": false,\n    \"is_cupon\": 0,\n    \"genericos\": 0,\n    \"spaces\": 1,\n    \"url\": \"263550021-crema-facial-cetaphil\",\n    \"status\": \"A\",\n    \"offerPriceByCity\": [],\n    \"RMS_PROVIDER\": \"GALDERMA MASIVO\",\n    \"metatituloSEO\": null,\n    \"metadesSEO\": null,\n    \"urlCanonical\": null,\n    \"customTag\": null,\n    \"desHiddenSEO\": null,\n    \"customLabelForStockZeroByCity\": [\n        {\n            \"cityCode\": \"BOG\",\n            \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n        }\n    ],\n    \"_collections\": [\n        \"Test\"\n    ],\n    \"objectID\": \"263550021\"\n}"
	responseOKCatalogProductsByObjectsID = "{\n    \"results\": [\n        {\n            \"deliveryTime\": \"35 min. promedio\",\n            \"labelPum\": \"Gramos a $\",\n            \"measurePum\": 48,\n            \"listUrlImages\": [\n                \"https://lh3.googleusercontent.com/YlFFxbzrydDnAhYXPad4LeVaJIS0rUesFdGGebQuDohRwXZszjhVX3RisyNYCCyTLPzaO-KCCqwMsogR6StzJi0fxr5P7dCGMAs7IHfrAam-aLzU\",\n                \"https://lh3.googleusercontent.com/iqZJjNBXcZf10ry3d2Jcm7BE3wt4N5pfM4nRImmI9HIFgKlUnhGL2dmAPvLXIftW7ebFfKfUsl_id-AarKy05WOtAEq2EZcDVN0t8T7SQU-zGBbg\",\n                \"https://lh3.googleusercontent.com/_5oF3ED1Dww6L-EzMC_OmrcSEFRcsxKx4zepkWFACQHjl0agAdf1dyR3spkEqZO2gT5O0ksxOnciRv3V-EGaFkiKAjD3EtfU_RvR5S3uquAKGkBX\",\n                \"https://lh3.googleusercontent.com/I5RlivL-BbQGAqxwPlv1c9o7IzSp-Loj07xK8jp9y3vktNCoVldb_exrIdbYa0IlV4sFs99ur9MYf_98VLGNSc4PHf_p1hu3Ej6ZAEFBNprxkYnc\",\n                \"https://lh3.googleusercontent.com/A6mkZoDcye3kJFywIN7ez9evNk8DMRgOg713jMicJ-9K6cigJvM4MvgR-U3WvMwB3dcGIbeDvwogNj9Fr5rSoaSNFZXsFs4VWcRk03tYis-j0iig\"\n            ],\n            \"outofstore\": false,\n            \"onlyOnline\": false,\n            \"marca\": \"Cetaphil\",\n            \"mediaImageUrl\": \"https://lh3.googleusercontent.com/4lhwm7XEzD6MZquvwnXR9qb2FgdW_IDS9uI3Bem78wVNCjqgPnM_KudM_M5Tvc46-tzxyaTwyYyXORw6Hb9qAoyuAwcstinPnD22-hUIBsFLrEzWNw\",\n            \"barcodeList\": [\n                \"263550021\",\n                \"3499320014540\",\n                \"03499320014540\"\n            ],\n            \"rms_deparment\": \"CUIDADO DE LA PIEL DERMOCOSMET\",\n            \"rms_class\": \"CUIDADO FACIAL DERMOCOSMETICOS\",\n            \"rms_group\": \"DERMOCOSMETICOS\",\n            \"rms_subclass\": \"CUIDADO FACIAL DERMOCOSMETICOS\",\n            \"fullPrice\": 148950,\n            \"sales\": 418,\n            \"classification\": [\n                {\n                    \"id\": 611,\n                    \"name\": \"Dermocosmética\",\n                    \"typeId\": 1,\n                    \"typeName\": \"DEPARTAMENTO\"\n                },\n                {\n                    \"id\": 612,\n                    \"name\": \"Facial\",\n                    \"typeId\": 2,\n                    \"typeName\": \"CATEGORIA\"\n                },\n                {\n                    \"id\": 616,\n                    \"name\": \"Hidratantes faciales\",\n                    \"typeId\": 3,\n                    \"typeName\": \"SUBCATEGORIA\"\n                }\n            ],\n            \"brand\": \"2008M-0008623\",\n            \"categorie\": \"Facial\",\n            \"departments\": [\n                \"Dermocosmética\"\n            ],\n            \"taxRate\": 19,\n            \"subCategory\": \"Hidratantes faciales\",\n            \"barcode\": \"3499320014540\",\n            \"mediaDescription\": \"Gel Hidratante Cetaphil Facial Water Gel x 48 gr\",\n            \"largeDescription\": \"Gel Hidratante Facial Cetaphil Water Gel brinda a la piel una hidratación intensa y prolonagada durante 72 horas. Ideal para todo tipo de pieles incluidas las mixtas y grasa.\",\n            \"stores_with_stock\": [\n                22,\n                1,\n                43,\n                42,\n                30,\n                51,\n                54,\n                83,\n                87,\n                91,\n                1110,\n                1134,\n                1148,\n                1118,\n                6,\n                11,\n                1000,\n                28,\n                29,\n                47,\n                44,\n                76,\n                1103,\n                1158,\n                1107,\n                1133,\n                1160,\n                1129,\n                1149,\n                2,\n                14,\n                26,\n                20,\n                72,\n                90,\n                88,\n                1105,\n                1112,\n                1113,\n                1135,\n                1141,\n                1125,\n                1155,\n                1130,\n                1137,\n                4,\n                24,\n                53,\n                32,\n                46,\n                81,\n                68,\n                85,\n                1119,\n                94,\n                1123,\n                96,\n                1145,\n                1001,\n                1176,\n                23,\n                61,\n                69,\n                63,\n                1104,\n                74,\n                1106,\n                1108,\n                1100,\n                1122,\n                1140,\n                1101,\n                1163,\n                40,\n                1151,\n                45,\n                50,\n                41,\n                80,\n                52,\n                71,\n                99,\n                1132,\n                93,\n                1126,\n                1165,\n                1146,\n                1150,\n                1156,\n                1175,\n                7,\n                3,\n                27,\n                89,\n                97,\n                64,\n                1131,\n                1109,\n                1136,\n                1115,\n                1147,\n                1117,\n                9,\n                19,\n                15,\n                16,\n                60,\n                39,\n                62,\n                73,\n                65,\n                67,\n                79,\n                98,\n                92,\n                1124,\n                1121,\n                1128,\n                1102,\n                1139,\n                1138,\n                1143,\n                1161,\n                1127\n            ],\n            \"id_highlights\": [\n                51933,\n                52276,\n                53477,\n                53691,\n                56268,\n                56370,\n                59257,\n                59925,\n                60038,\n                60251,\n                60318,\n                60441,\n                60929,\n                61395,\n                61680,\n                61761,\n                61925,\n                61935,\n                61976,\n                62013,\n                62036,\n                62217,\n                62258,\n                62357,\n                62380,\n                62421,\n                62498,\n                62539,\n                63097,\n                63836,\n                63857,\n                64663,\n                64756,\n                64805,\n                64806,\n                65297,\n                65337,\n                65376,\n                65379,\n                65416,\n                65436,\n                65456,\n                65468,\n                65475,\n                65601,\n                65710,\n                65823,\n                65857,\n                66245,\n                66600,\n                66601,\n                66623,\n                66632,\n                66633,\n                66725,\n                66758,\n                66849,\n                66905,\n                66979,\n                67099,\n                67214\n            ],\n            \"offerPrice\": 111712.5,\n            \"offerText\": \"25%\",\n            \"offerDescription\": \"¡Aprovecha!\",\n            \"stores_with_offer\": [\n                26,\n                80,\n                53,\n                54,\n                2,\n                4,\n                67,\n                31,\n                20,\n                14,\n                81,\n                39,\n                19,\n                5,\n                79,\n                68,\n                61,\n                60,\n                49,\n                46,\n                42,\n                41,\n                40,\n                37,\n                32,\n                30,\n                29,\n                27,\n                24,\n                23,\n                22,\n                21,\n                18,\n                17,\n                16,\n                15,\n                13,\n                12,\n                11,\n                10,\n                9,\n                7,\n                6,\n                3,\n                83,\n                85,\n                0,\n                86,\n                25,\n                8,\n                99,\n                1112,\n                1122,\n                1135,\n                1115,\n                1141,\n                88,\n                89,\n                1175,\n                43,\n                74,\n                63,\n                50,\n                45,\n                44,\n                47,\n                1102,\n                1136,\n                1147,\n                1127,\n                51,\n                52,\n                62,\n                76,\n                1123,\n                64,\n                72,\n                71,\n                65,\n                1116,\n                69,\n                73,\n                1140,\n                93,\n                94,\n                1104,\n                1105,\n                92,\n                1101,\n                91,\n                1107,\n                1113,\n                1137,\n                96,\n                1156,\n                97,\n                98,\n                1106,\n                1108,\n                1100,\n                1103,\n                1109,\n                1110,\n                1131,\n                1119,\n                1158,\n                1000,\n                1001,\n                1117,\n                1118,\n                1121,\n                1124,\n                1128,\n                1143,\n                1146,\n                1176,\n                1125,\n                1139,\n                1129,\n                1132,\n                95,\n                1134,\n                1133,\n                1130,\n                1151,\n                1160,\n                1161,\n                1163,\n                1165,\n                28,\n                1126\n            ],\n            \"id\": \"263550021\",\n            \"primePrice\": 104265,\n            \"primeTextDiscount\": \"30%\",\n            \"primeDescription\": \"¡Aprovecha!\",\n            \"Prime\": \"si\",\n            \"stores_with_prime_offer\": [\n                26,\n                80,\n                53,\n                54,\n                2,\n                4,\n                67,\n                31,\n                20,\n                14,\n                81,\n                39,\n                19,\n                5,\n                79,\n                68,\n                61,\n                60,\n                49,\n                46,\n                42,\n                41,\n                40,\n                37,\n                32,\n                30,\n                29,\n                27,\n                24,\n                23,\n                22,\n                21,\n                18,\n                17,\n                16,\n                15,\n                13,\n                12,\n                11,\n                10,\n                9,\n                7,\n                6,\n                3,\n                83,\n                85,\n                0,\n                86,\n                25,\n                8,\n                99,\n                1112,\n                1122,\n                1135,\n                1115,\n                1141,\n                88,\n                89,\n                1175,\n                43,\n                74,\n                63,\n                50,\n                45,\n                44,\n                47,\n                1102,\n                1136,\n                1147,\n                1127,\n                51,\n                52,\n                62,\n                76,\n                1123,\n                64,\n                72,\n                71,\n                65,\n                1116,\n                69,\n                73,\n                1140,\n                93,\n                94,\n                1104,\n                1105,\n                92,\n                1101,\n                91,\n                1107,\n                1113,\n                1137,\n                96,\n                1156,\n                97,\n                98,\n                1106,\n                1108,\n                1100,\n                1103,\n                1109,\n                1110,\n                1131,\n                1119,\n                1158,\n                1000,\n                1001,\n                1117,\n                1118,\n                1121,\n                1124,\n                1128,\n                1143,\n                1146,\n                1176,\n                1125,\n                1139,\n                1129,\n                1132,\n                95,\n                1134,\n                1133,\n                1130,\n                1151,\n                1160,\n                1161,\n                1163,\n                1165,\n                28,\n                1126\n            ],\n            \"id_suggested\": [\n                24611\n            ],\n            \"fullPriceByCity\": [\n                {\n                    \"cityCode\": \"VVC\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"ELL\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"ENV\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"TAG\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"MED\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"BUC\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"IDA\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"IRO\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"ALI\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"JIC\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"PAQ\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"LAR\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"CIR\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"ARM\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"GAI\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"SMR\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"GSC\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"LAC\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"AMU\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"BOG\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"CUT\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"VRO\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"SPA\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"DOS\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"PER\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"CHI\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"BAR\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"OMB\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"CTG\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"SOL\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"SOA\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"VUP\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"INI\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"RET\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"ION\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"CTA\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"VLL\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"NIZ\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"TER\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"PIE\",\n                    \"fullPrice\": 148950\n                },\n                {\n                    \"cityCode\": \"NET\",\n                    \"fullPrice\": 148950\n                }\n            ],\n            \"idOffersGroup\": [\n                52088\n            ],\n            \"offerStartDate\": 1746075600000,\n            \"offerEndDate\": 1746507540000,\n            \"lastUpdate\": {\n                \"jobName\": \"UPDATE_SUGGEST\",\n                \"timeStamp\": 1747263900270\n            },\n            \"supplier\": \"GALDERMA MASIVO\",\n            \"grayDescription\": \" \",\n            \"highlight\": \"false\",\n            \"requirePrescription\": \"false\",\n            \"anywaySelling\": false,\n            \"is_cupon\": 0,\n            \"genericos\": 0,\n            \"spaces\": 1,\n            \"url\": \"263550021-crema-facial-cetaphil\",\n            \"status\": \"A\",\n            \"offerPriceByCity\": [],\n            \"RMS_PROVIDER\": \"GALDERMA MASIVO\",\n            \"metatituloSEO\": null,\n            \"metadesSEO\": null,\n            \"urlCanonical\": null,\n            \"customTag\": null,\n            \"desHiddenSEO\": null,\n            \"customLabelForStockZeroByCity\": [\n                {\n                    \"cityCode\": \"BOG\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"BOG\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"BOG\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"BOG\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"BAR\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"BAR\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"BAR\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"SOL\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"SOA\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"SMR\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"CTG\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"VUP\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"ALI\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"ION\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"ION\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"MED\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"MED\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"JIC\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"LAC\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"CTA\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"CUT\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"CUT\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"TER\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"AMU\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"BUC\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"NET\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"ARM\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"PER\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"NIZ\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"PIE\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                },\n                {\n                    \"cityCode\": \"CHI\",\n                    \"customLabel\": \"Pocas unidades | Solo en tiendas\"\n                }\n            ],\n            \"_collections\": [\n                \"Test\"\n            ],\n            \"objectID\": \"263550021\"\n        }\n    ]\n}"
	urlCatalogProductMock                = "/1/indexes/products-colombia/123"
	urlCatalogProductByObjectsIDMock     = "/1/indexes/*/objects"
)

var products = []string{"263550021", "3499320014540", "03499320014540"}

func Test_GetProductInformationWhenSuccess(t *testing.T) {
	controller := gomock.NewController(t)
	defer controller.Finish()

	server := mocks_server.ConfigMockSrver(responseOKCatalogProducts,
		urlCatalogProductMock, http.MethodGet, http.StatusOK, "{}")

	defer server.Close()

	config.Enviroments.CatalogProductsUrl = server.URL

	gin.SetMode(gin.TestMode)

	ctx, _ := gin.CreateTestContext(httptest.NewRecorder())
	ctx.Request = &http.Request{Header: make(http.Header), URL: &url.URL{}}

	ctx.Set("X-Correlation-ID", "1291823jhau1uha")

	httpCatalogProduct := NewCatalogProduct()

	data, err := httpCatalogProduct.GetProductInformation(ctx, "123")

	assert.NoError(t, err)
	assert.Equal(t, data.Brand, "2008M-0008623")
}

func Test_GetProductsInformationByObjectIDWhenSuccess(t *testing.T) {
	controller := gomock.NewController(t)
	defer controller.Finish()

	server := mocks_server.ConfigMockSrver(responseOKCatalogProductsByObjectsID,
		urlCatalogProductByObjectsIDMock, http.MethodPost, http.StatusOK, "{}")

	defer server.Close()

	config.Enviroments.CatalogProductsUrl = server.URL

	gin.SetMode(gin.TestMode)

	ctx, _ := gin.CreateTestContext(httptest.NewRecorder())
	ctx.Request = &http.Request{Header: make(http.Header), URL: &url.URL{}}

	ctx.Set("X-Correlation-ID", "1291823jhau1uha")

	httpCatalogProduct := NewCatalogProduct()

	data, err := httpCatalogProduct.GetProductsInformationByObjectID(ctx, products, "CO")

	assert.NoError(t, err)
	assert.Equal(t, data[0].Brand, "2008M-0008623")
}
